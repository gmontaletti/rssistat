% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/download_files.R
\name{download_attachments}
\alias{download_attachments}
\title{Download Attachments from RSS Feed}
\usage{
download_attachments(
  feed,
  types = c("pdf", "xlsx", "xls", "csv", "zip"),
  since = Sys.Date(),
  destdir = ".",
  create_subdir = TRUE,
  overwrite = FALSE,
  timeout = 60,
  verbose = FALSE
)
}
\arguments{
\item{feed}{An rss_feed object created by \code{\link{fetch_feed}}.}

\item{types}{Character vector of file extensions to download. Case-insensitive.
Default: \code{c("pdf", "xlsx", "xls", "csv", "zip")}.}

\item{since}{Filter to items published on or after this date. Accepts Date,
POSIXct, or character in "YYYY-MM-DD" format. Default \code{Sys.Date()}
downloads only items published today or later.}

\item{destdir}{Destination directory for downloads. Created if it does not exist.
Default: \code{"."} (current directory).}

\item{create_subdir}{Logical. If \code{TRUE}, creates subdirectory structure
\code{{theme}/{YYYYMMDD}/} where YYYYMMDD is each item's publication date.
Items without valid pub_date use the current date. Default: \code{TRUE}.}

\item{overwrite}{Logical. If \code{TRUE}, overwrites existing files. If \code{FALSE},
skips downloads for existing files. Default: \code{FALSE}.}

\item{timeout}{Numeric. Download timeout per file in seconds. Default: \code{60}.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages during download.
Default: \code{FALSE}.}
}
\value{
A \code{data.table} with one row per download attempt, containing:
\describe{
\item{url}{Character. Original URL of the file.}
\item{filename}{Character. Downloaded file name.}
\item{path}{Character. Full local path to downloaded file.}
\item{size}{Numeric. File size in bytes (NA if download failed).}
\item{status}{Character. One of "downloaded", "skipped" (file exists), or "failed".}
\item{error}{Character. Error message if status is "failed", NA otherwise.}
}
}
\description{
Downloads files (PDF, Excel, CSV, ZIP, etc.) linked in RSS feed items.
Supports automatic directory organization by theme and date, with progress
tracking and error handling.
}
\examples{
\dontrun{
# Fetch feed and download all PDFs
feed <- fetch_feed("https://www.istat.it/en/theme/prices/feed")
results <- download_attachments(feed, types = "pdf", destdir = "downloads")
print(results)

# Download multiple file types with progress messages
results <- download_attachments(
  feed,
  types = c("pdf", "xlsx", "csv"),
  destdir = "data",
  verbose = TRUE
)

# Download without subdirectory structure, overwrite existing
results <- download_attachments(
  feed,
  types = "xlsx",
  destdir = "flat_downloads",
  create_subdir = FALSE,
  overwrite = TRUE
)

# Download files from last 30 days
results <- download_attachments(feed, since = Sys.Date() - 30)

# Download files from specific date onwards
results <- download_attachments(feed, since = "2025-01-01")

# Download all files regardless of date
results <- download_attachments(feed, since = as.Date("1970-01-01"))
}

}
